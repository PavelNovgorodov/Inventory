Версия 2.2
Изменена компоновка решения. Весь функционал перенесен в модуль Start-Inventory.psm1 (командлет Start-Inventory), все функции вызываются через данный модуль.
Модуль размещается в каталоге InvStart, в данном каталоге размещен подкаталог Function (содержит все используемые скрипты).
Файл настроек Inventory.Settings.xml больше не используется, параметры запуска передаются при вызове командлета Start-Inventory.
Файл справочник типов инвентаризации InvType.json больше не используется, справочник перенесен в хэш-таблицу в скрипте \InvStart\Function\InvType.ps1.
Для удобства запуска функционала созданы два скрипта InvRemote.ps1 (запуск удаленной инвентаризации) и InvWork.ps1 (запуск обработки собранной информации).

Функционал локального сбора инвентаризационной информации перенесен в модуль Start-LocalInventory.psm1 (командлент Start-LocalInventory).
Файл настроек Inventory.Settings.xml больше не используется, параметры запуска передаются при вызове командлета Start-LocalInventory.
Запуск выполняется с использованием скрипта InvLocal.ps1

Справочник типов инвентаризации формируется автоматически (скрипт InvType.ps1), в хэш таблицу $global:InvType на основе содежимого расположенного 
в тегах <Description></Description> расположенных в описании каждого модуля сбора информации командлета Get-Inventory.

Версия 2.3
Функционал локального сбора (Start-LocalInventory.psm1) перенесен в Start-Inventory.psm1. 
Добавлен параметр запуска Start-Inventory -StartType InvLocal.
Создан файл InvLocal.ps1 для запуска локальной инвентаризации.

Версия 2.4
Исправлены обнаруженные ошибки.

Версия 2.5
Добавлен скрипт \Function\Get-FolderAccess.ps1 - получение NTFS разрешений для каталога. Возможно получение разрешений для вложенных каталогов (см. описание в тексте скрипта).

Доработан модуль сбора \Function\Get-Inventory-Module\shr.ps1, добавлена возможность получения разрешений на уровне общего ресурса, и на уровне NTFS разрешений каталогов ресурса.
Возможно управление уровнем вложенности. По умлочанию уровень вложенности 0 - определяются права только на уровне общего ресурса и NTFS права для каталога ресурса.
Используется функция \Function\Get-FolderAccess.ps1

Доработан командлет \InvStart\Start-Inventory.psm1, добавлен параметр запуска -ModuleParameter (дополнительные параметры модулей сбора - массив хэш-таблиц).
Параметр добавлен с целью возможности передачи значения в модуль shr.ps1 (переменная $DepthChildFolder).
Массив используется чтобы можно было передавать несколько значений, хэш-таблица чтобы можно было унифицировать передаваемые параметры (вдруг пригодится в будущем).
Если параметр -ModuleParameter передан, его значения передаются в глобальную переменную $global:MParameters которая используется в модуле shr.ps1 для получения значений переменной:
	$DepthChildFolder = ($global:MParameters | Where-Object {$_["Module"] -eq "shr" -and $_["VarName"] -eq "DepthChildFolder"}).VarValue

Примеры запуска командлета Start-Inventory.psm1 и передача значений в параметр -ModuleParameter приведены в документации и тексте командлета.

В связи с тем что формат файлов (используемые поля) InvAnyComputers\*.shr.csv изменился, то при переходе на версию 2.5 требуется выполнить одно из двух действий:
1. Удалить все файлы InvAnyComputers\*.shr.csv и заново собрать инвентаризационные данные
или
2. Выполнить скрипт \InvStart\Utils\UpdateCSV.ps1 (предварительно проверить и при необходимости указать корректный путь в переменной $InvAnyComputers = "C:\SHARE\Inventory\InvAnyComputers",
скрипт скорректирует формат (поля) файлов *.shr.csv.

Доработана документация.

Версия 2.6
Модуль \Function\Get-Inventory-Module\mnt.ps1 добавлен сбор - неделя и год производства монитора.

Модуль \Function\Get-Inventory-Module\gpu.ps1 добавлен сбор - текущее используемое разрешение.

Модуль Function\Get-Inventory-Module\shr.ps1
В ходе анализа собранных данных модуля shr (сбора NTFS разрешений для каталогов общих ресурсов) было выявлено что не всегда удобно задавать уровень вложенности каталогов общих ресурсов
для всех объектов сбора.
В частности при использовании уровня вложенности 2 - с одного из серверов (сервер витрины СТД) было получено 500 тыс. записей.
В связи с этим в модуль добавлена возможность задания уровня вложенности каталогов при получении NTFS разрешений индивидуально для определенных компьютеров.
Для этогод в модуль добавлена переменная $DepthAnyComputer - массив с перечнем компьютеров с указанием уровня вложенности.
Возможно задавать имя компьютера с использованием маски. Значения в переменную передаются через параметр -ModuleParameter командлета \InvStart\Start-Inventory.psm1.
	Например, 
		$m = @(
        		@{Module   = "shr"; VarName  = "DepthAnyComputer"; VarValue = ("s37fs*", 3), ("s37as40", 3), ("s37ap18", 3)}
		      )
Для всех компьютеров, кроме перечисленных в параметре, будут собраны по умолчанию NTFS разрешения для каталогов шары (без вложенных каталогов).
Для компьютеров, перечисленных в параметрах, будут собраны NTFS разрешения с вложенных каталогов с указанным уровнем вложенности.
Если компьютер перечислен в нескольких значениях (в том числе по маске) - будет использоваться последнее значение.

Возможно использовать оба параметра DepthChildFolder и DepthAnyComputer одновременно, например:
	$m = @(
		@{Module = "shr"; VarName = "DepthChildFolder"; VarValue = -1},
	
		@{Module = "shr"; VarName = "DepthAnyComputer"; VarValue = ("s37fs*", 2), ("s37fs03", 2), ("s37fs04", 3), ("s37fs06", 0), ("s37as40", 2), ("s37ap18", 2)}
              )
	Будут сбораны разрешения для каталогов общих ресурсов, с учетов вложенности каталогов, только для комьпютеров перечисленных в значении параметра DepthAnyComputer,
	для всех остальных NTFS разрешения не будут собраны т.к. параметр DepthChildFolder = -1

Доработана документация.

Обновление до версии 2.6.
В связи с тем что в модулях mnt.ps1 и gpu.ps1 добавлен сбор дополнительной информации, перед обновлением рекомендуется удалить все файлы в каталоге \InvAnyComputers
по маске *mnt.csv и gpu.csv и выполнить сбор заново.	

Версия 2.7
Командлет Start-Inventory.psd1 добавлен параметр -InvRemoteDayOld - проверять наличие файлов инвентаризационной информации старше установленного количества дней перед удаленным сбором,
(по умолчанию 0 - не проверять).
Модуль \Function\PollComputers.ps1 доработано использование параметра -InvRemoteDayOld. Если задан данный параметр (больше 0) удаленный сбор будет осуществлятся только с тех компьютеров,
для которых нет актуальных файлов инвентаризации (нет файлов старше текущая дата - InvRemoteDayOld).
Доработана документация.
Обновление до версии 2.7 - скопировать файлы Start-Inventory.psd1, Start-Inventory.psm1 и \Function\PollComputers.ps1 по месту расположения.
При необходимости настроить использование параметра -InvRemoteDayOld в скрипте InvRemote.ps1

Версия 2.8
Выполнен рефакторинг - изменено расположение каталогов решения:
Inventory
    |-- Docs                            # Документация
    |-- Src                             # Расположение командлета и скриптов запуска командлета
    |   |-- Results       # Расположение файлов результатов инвентаризации
    |   |-- Report       # Расположение файла отчета XLS
    |   |    |- inv.xlsm    # Файл отчета XLS
    |   |    |- inv.html.styles.css     # Файл стилей для HTML отчета
    |   |-- Modules               # Основные скрипты командлета
    |   |    |- Get-Inventory-Module # Расположение модулей командлета Get-Inventory (имя модуля = обозначение типа информации)
    |   |    |   |-- dsk.ps1      # Модуль сбора логических дисков
    |   |    |   |-- evt.ps1      # Модуль сбора событий включения и выключения компьютера
    |   |    |   |-- gpu.ps1      # Модуль сбора графических адаптеров
    |   |    |   |-- grp.ps1      # Модуль сбора состава локальных групп
    |   |    |   |-- hdd.ps1      # Модуль сбора физических дисков
    |   |    |   |-- hfx.ps1      # Модуль сбора установленных обновлений ОС
    |   |    |   |-- hwr.ps1      # Модуль сбора аппратной конфигураци
    |   |    |   |-- map.ps1      # Модуль сбора подключенных сетевых дисков
    |   |    |   |-- mnt.ps1      # Модуль сбора информации о подключенных мониторах
    |   |    |   |-- net.ps1      # Модуль сбора информации по сетевым интерфейсам
    |   |    |   |-- pci.ps1      # Модуль сбора PCI устройств
    |   |    |   |-- prf.ps1      # Модуль сбора профилей пользователей
    |   |    |   |-- ram.ps1      # Модуль сбора модули памяти
    |   |    |   |-- shr.ps1      # Модуль сбора информации по общим ресурса
    |   |    |   |-- svc.ps1      # Модуль сбора служб ОС
    |   |    |   |-- swr.ps1      # Модуль сбора установленного ПО
    |   |    |   |-- tsk.ps1      # Модуль сбора заданий планировщика
    |   |    |   |-- usr.ps1      # Модуль сбора локальных пользователей
    |   |    |   |-- reg.ps1      # Модуль сбора значений параметров реестра
    |   |    |-- Get-Inventory.ps1   # Командлет Get-Inventory
    |   |    |-- CheckFolder.ps1     # Проверка используемых каталогов
    |   |    |-- CheckLogFile.ps1     # Проверка возможности ведения файла протокола
    |   |    |-- CheckOU.ps1      # Проверка параметра InvOU (OU AD)
    |   |    |-- CreateResult.ps1     # Модуль формирование итоговых файлов с результатами инвентаризации
    |   |    |-- DeleteOld.ps1      # Модуль удаления старых файлов инвентаризации
    |   |    |-- Get-Computer.ps1     # Командлет получения перечня компьютеров в домене
    |   |    |-- Get-FolderAccess.ps1 # Модуль получения разрешений NTFS для каталога, включая вложенные каталоги
    |   |    |-- InvLocal.ps1      # Модуль запуска локальной инвентаризации
    |   |    |-- InvType.ps1      # Модуль формирования справочника типов инветаризации
    |   |    |-- ListComputers.ps1     # Модуль получения перечня компьютеров с которых будет выполнен сбор
    |   |    |-- PollComputers.ps1     # Модуль удаленного сбора инвентаризации
    |   |    |-- SelectInvType.ps1     # Модуль выбора типов собираемой информатизации
    |   |    |-- UnZIP.ps1          # Модуль распаковки ZIP архивов с файлами инвентаризации
    |   |    |-- WriteLog.ps1      # Модуль записи в лог файл
    |   |-- InvLocal.cmd          # Командный файл запуска процедуры локальной инвентаризации
    |   |-- InvLocal.ps1          # Скрипт запуска локального сбора инвентаризации
    |   |-- InvRemote.ps1          # Скрипт запуска удаленного сбора инвентаризации
    |   |-- InvWork.ps1           # Скрипт запуска обработки информации
    |   |-- Start-Inventory.psm1        # Командлет сбора и обработка инвентаризационной информации
    |   |-- Start-Inventory.psd1     # Манифест для Start-Inventory.psm1

Добавлен модуль сбора параметров реестра \Src\Modules\Get-Inventory-Module\reg.ps1
Могут быть собраны значения всех параметров и вложенных ключей или значение конкретного параметра ключа реестра.
Настройка сбора осуществляется через передачу дополнительного параметра в модуль reg.ps1 через параметр запуска -ModuleParameters командлета Start-Inventory.

    Например,
        $Parameters = @(
                        @{
                            Module = "reg";
                            VarName = "Reg";
                            VarValue = @(
					    #собрать все значения включая вложенные ключи
                                            @{HKey = "HKEY_CURRENT_USER"; Key = "SOFTWARE\Microsoft\Windows\CurrentVersion\Run"}, 
					    #собрать все значения включая вложенные ключи
                                            @{HKey = "HKEY_CURRENT_USER"; Key = "SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"}, 
                                            @{HKey = "HKEY_USERS"; Key = "SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings"; ValueName = "AutoConfigURL"} #собрать значение параметра AutoConfigURL
                                         )
                         }
                       )
        #запуск командлета
        Start-Inventory -StartType InvRemote -ModuleParameters $Parameters
    
        Использумые ключи хэш таблицы:
        HKey - раздел реестра ("HKEY_USERS", "HKEY_LOCAL_MACHINE", "HKEY_CURRENT_USER", "HKEY_CLASSES_ROOT", "HKEY_CURRENT_CONFIG")
        Key - наименование ключа (строка)
        ValueName - наменование параметра (строка)

Добавлены в каталоге \Docs
 - Inventory.bpmn - BPMN схема процессов сбор и обработки
 - Алгоритм работы командлета.md - алгоритм работы командлета в формате markdwon + mermaid
Обновлена документация.

Обновление до версии 2.8.
1. Сохранить содержимое каталогов InvAnyComputers, InvResult, файлы содержащие настройки путей запуска InvLocal.ps1, InvRemote.ps1, InvWork.ps1, InvLocal.cmd
2. Полностью заменить все файл решения.
3. Восстановить сохраненное содержимое каталогов и файлов в п.1
